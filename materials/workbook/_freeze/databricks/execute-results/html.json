{
  "hash": "aa43e52f1a18ae3d4e6a3ca537fe9d84",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Databricks Connect\"\nexecute: \n  eval: true\n  freeze: true\n  warning: false\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sparklyr)\nlibrary(dplyr)\nsc <- spark_connect(method = \"databricks_connect\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nflights_mapped <- spark_read_csv(\n  sc = sc,\n  name = \"mapped\",\n  path = \"/Volumes/workshops/nycflights/2013\",\n  memory = FALSE\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nflights_mapped |> \n  glimpse()\n#> Rows: ??\n#> Columns: 16\n#> Database: spark_connection\n#> $ year      <int> 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, …\n#> $ month     <int> 6, 5, 12, 5, 7, 1, 12, 8, 9, 4, 6, 11, 4, 3, 10, 1, 2, 8, 10…\n#> $ day       <int> 30, 7, 8, 14, 21, 1, 9, 13, 26, 30, 17, 22, 26, 25, 21, 23, …\n#> $ dep_time  <int> 940, 1657, 859, 1841, 1102, 1817, 1259, 1920, 725, 1323, 940…\n#> $ dep_delay <int> 15, -3, -1, -4, -3, -3, 14, 85, -10, 62, 5, 5, -2, 115, -4, …\n#> $ arr_time  <int> 1216, 2104, 1238, 2122, 1230, 2008, 1617, 2032, 1027, 1549, …\n#> $ arr_delay <int> -4, 10, 11, -34, -8, 3, 22, 71, -8, 60, -4, -2, 22, 91, -6, …\n#> $ carrier   <chr> \"VX\", \"DL\", \"DL\", \"DL\", \"9E\", \"AA\", \"WN\", \"B6\", \"AA\", \"EV\", …\n#> $ tailnum   <chr> \"N626VA\", \"N3760C\", \"N712TW\", \"N914DL\", \"N823AY\", \"N3AXAA\", …\n#> $ flight    <int> 407, 329, 422, 2391, 3652, 353, 1428, 1407, 2279, 4162, 20, …\n#> $ origin    <chr> \"JFK\", \"JFK\", \"JFK\", \"JFK\", \"LGA\", \"LGA\", \"EWR\", \"JFK\", \"LGA…\n#> $ dest      <chr> \"LAX\", \"SJU\", \"LAX\", \"TPA\", \"ORF\", \"ORD\", \"HOU\", \"IAD\", \"MIA…\n#> $ air_time  <int> 313, 216, 376, 135, 50, 138, 240, 48, 148, 110, 50, 161, 87,…\n#> $ distance  <int> 2475, 1598, 2475, 1005, 296, 733, 1411, 228, 1096, 820, 264,…\n#> $ hour      <int> 9, 16, 8, 18, 11, 18, 12, 19, 7, 13, 9, 13, 8, 20, 12, 20, 6…\n#> $ minute    <int> 40, 57, 59, 41, 2, 17, 59, 20, 25, 23, 40, 20, 9, 54, 17, 24…\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nflights_mapped |> \n  count(carrier)\n#> # Source:   SQL [?? x 2]\n#> # Database: spark_connection\n#>    carrier     n\n#>    <chr>   <dbl>\n#>  1 UA       5770\n#>  2 AA       3188\n#>  3 EV       5142\n#>  4 B6       5376\n#>  5 DL       4751\n#>  6 OO          3\n#>  7 F9         69\n#>  8 YV         53\n#>  9 US       2015\n#> 10 MQ       2507\n#> # ℹ more rows\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsdf_sql(sc, \"select * from mapped limit 10\")\n#> # Source:   table<`sparklyr_tmp_table_0a97d025_7b88_4f3e_8ba1_38923b5ab6ce`> [10 x 16]\n#> # Database: spark_connection\n#>     year month   day dep_time dep_delay arr_time arr_delay carrier tailnum\n#>    <int> <int> <int>    <int>     <int>    <int>     <int> <chr>   <chr>  \n#>  1  2013     6    30      940        15     1216        -4 VX      N626VA \n#>  2  2013     5     7     1657        -3     2104        10 DL      N3760C \n#>  3  2013    12     8      859        -1     1238        11 DL      N712TW \n#>  4  2013     5    14     1841        -4     2122       -34 DL      N914DL \n#>  5  2013     7    21     1102        -3     1230        -8 9E      N823AY \n#>  6  2013     1     1     1817        -3     2008         3 AA      N3AXAA \n#>  7  2013    12     9     1259        14     1617        22 WN      N218WN \n#>  8  2013     8    13     1920        85     2032        71 B6      N284JB \n#>  9  2013     9    26      725       -10     1027        -8 AA      N3FSAA \n#> 10  2013     4    30     1323        62     1549        60 EV      N12163 \n#> # ℹ 7 more variables: flight <int>, origin <chr>, dest <chr>, air_time <int>,\n#> #   distance <int>, hour <int>, minute <int>\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl_flights <- spark_read_csv(\n  sc = sc, \n  name = \"cached\", \n  path = \"/Volumes/workshops/nycflights/2013\"\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsdf_sql(sc, \"select * from cached limit 10\")\n#> # Source:   table<`sparklyr_tmp_table_9b6f4f93_b9bf_4658_a173_e8ea2e83ae8b`> [10 x 16]\n#> # Database: spark_connection\n#>     year month   day dep_time dep_delay arr_time arr_delay carrier tailnum\n#>    <int> <int> <int>    <int>     <int>    <int>     <int> <chr>   <chr>  \n#>  1  2013     6    30      940        15     1216        -4 VX      N626VA \n#>  2  2013     5     7     1657        -3     2104        10 DL      N3760C \n#>  3  2013    12     8      859        -1     1238        11 DL      N712TW \n#>  4  2013     5    14     1841        -4     2122       -34 DL      N914DL \n#>  5  2013     7    21     1102        -3     1230        -8 9E      N823AY \n#>  6  2013     1     1     1817        -3     2008         3 AA      N3AXAA \n#>  7  2013    12     9     1259        14     1617        22 WN      N218WN \n#>  8  2013     8    13     1920        85     2032        71 B6      N284JB \n#>  9  2013     9    26      725       -10     1027        -8 AA      N3FSAA \n#> 10  2013     4    30     1323        62     1549        60 EV      N12163 \n#> # ℹ 7 more variables: flight <int>, origin <chr>, dest <chr>, air_time <int>,\n#> #   distance <int>, hour <int>, minute <int>\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsub_flights <- tbl_flights |> \n  select(year, month, day) |> \n  compute()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsub_flights\n#> # Source:   table<`table_a3efd795_76cd_4df7_a5dc_cf25e8721521`> [?? x 3]\n#> # Database: spark_connection\n#>     year month   day\n#>    <int> <int> <int>\n#>  1  2013     6    30\n#>  2  2013     5     7\n#>  3  2013    12     8\n#>  4  2013     5    14\n#>  5  2013     7    21\n#>  6  2013     1     1\n#>  7  2013    12     9\n#>  8  2013     8    13\n#>  9  2013     9    26\n#> 10  2013     4    30\n#> # ℹ more rows\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}