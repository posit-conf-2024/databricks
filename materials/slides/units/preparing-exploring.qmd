---
format: 
  revealjs:
    width: 1600
    height: 920
    max-scale: 1
    min-scale: 1
    smaller: true
    transition: fade
    background-transition: fade
    theme: theme.scss
    code-line-numbers: false
    menu: true
    code-block-height: 640px
    slide-number: true
engine: knitr
---

```{r}
#| include: false
unit_no <- 3
```

## {background-image="assets/background/content-slide.svg" background-size="1700px" background-color="#2a7070"}

:::{.content-slide-title}
Unit `r unit_no`
:::

:::{.content-slide}
[Preparing <br/>
and exploring <br/>
data]{style="font-size:130px;"}
:::


## [Variable selection]{style="color:#666;"} {background-image="assets/background/slide-light.svg" background-size="1700px" background-color="white"}
:::{.custom2}
Using `select()` with these functions make variable selection easy: 
:::

:::{.columns}
:::{.column width="10%"}
:::
:::{.column width="80%"}
:::{.custom2}
- `starts_with()` - Starts with an exact prefix
- `ends_with()` - Ends with an exact suffix
- `contains()` - Contains a literal string
- `everything()` - Selects everything else. Use with other selection functions.
:::
:::
:::

## {background-image="assets/background/boxed-green.svg" background-size="1700px" background-color="#799857"}

:::{.green-slide}
Exercise `r unit_no`.1
:::

## [Joining tables]{style="color:#666;"} {background-image="assets/background/slide-light.svg" background-size="1700px" background-color="white"}

![](assets/prepare-exploring/join-x.png){.absolute top="100" left="600"}
![](assets/prepare-exploring/join-y.png){.absolute top="100" left="800"}

<br/><br/><br/><br/><br/><br/>

:::{.columns}
:::{.column width="10%"}
:::
:::{.column width="30%"}
`left_join()`
:::
:::{.column width="30%"}
`right_join()`
:::
:::{.column width="30%"}
`full_join()`
:::
:::

![](assets/prepare-exploring/join-left.png){.absolute top="500" left="170"}
![](assets/prepare-exploring/join-right.png){.absolute top="500" left="660"}
![](assets/prepare-exploring/join-full.png){.absolute top="500" left="1150"}

## {background-image="assets/background/boxed-green.svg" background-size="1700px" background-color="#799857"}

:::{.green-slide}
Exercise `r unit_no`.2
:::


## [Preparing data]{style="color:#666;"} {background-image="assets/background/slide-light.svg" background-size="1700px" background-color="white"}

:::{.custom2}
Load prepared data to a variable, without downloading it
:::

:::{.sample-code}
```r
prep_orders <- orders |> 
  left_join(customers, by = c("o_custkey" = "c_custkey")) |> 
  left_join(nation, by = c("c_nationkey" = "n_nationkey")) |> 
  mutate(
    order_year = year(o_orderdate), 
    order_month = month(o_orderdate)
  ) |> 
  rename(customer = o_custkey) |> 
  select(-ends_with("comment"),  -ends_with("key"))
```
:::

## {background-image="assets/background/boxed-green.svg" background-size="1700px" background-color="#799857"}

:::{.green-slide}
Exercise `r unit_no`.3
:::

## [Exploring data]{style="color:#666;"} {background-image="assets/background/slide-light.svg" background-size="1700px" background-color="white"}

:::{.custom2}
Use the base query for data exploration
:::

:::{.sample-code}
```r
prep_orders |> 
  group_by(n_name) |> 
  summarise(total_price = sum(o_totalprice, na.rm = TRUE)) |> 
  arrange(desc(total_price)) |> 
  head(5)
#>   n_name     total_price
#>   <chr>            <dbl>
#> 1 IRAQ      45968155784.
#> 2 INDONESIA 45921526909.
#> 3 GERMANY   45725194460.
#> 4 FRANCE    45713656960.
#> 5 IRAN      45708446851.
```
:::

## {background-image="assets/background/boxed-green.svg" background-size="1700px" background-color="#799857"}

:::{.green-slide}
Exercise `r unit_no`.4
:::

